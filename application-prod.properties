# 生产环境配置 - 宝塔部署

# ==================== 服务器配置 ====================
server.port=8080
server.servlet.context-path=/api
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/css,text/plain,text/javascript,application/json,application/xml

# ==================== 数据库配置 ====================
# MySQL数据库连接
spring.datasource.url=jdbc:mysql://localhost:3306/my-blog?useSSL=false&serverTimezone=Asia/Shanghai&characterEncoding=utf8&allowPublicKeyRetrieval=true
spring.datasource.username=blog_user
spring.datasource.password=your_mysql_password_here

# 数据库连接池
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ==================== JWT配置 ====================
# JWT密钥（生产环境请使用复杂的随机字符串）
jwt.secret=your_very_secure_jwt_secret_key_min_32_chars_here
jwt.expiration=86400000  # 24小时

# ==================== MyBatis配置 ====================
mybatis.mapper-locations=classpath:com/easy/mapper/*.xml
mybatis.type-aliases-package=com.easy.entity
mybatis.configuration.map-underscore-to-camel-case=true
mybatis.configuration.cache-enabled=true

# ==================== 日志配置 ====================
# 日志级别
logging.level.com.easy=INFO
logging.level.org.springframework.web=INFO
logging.level.org.mybatis=INFO

# 日志文件配置
logging.file.name=app.log
logging.file.path=./logs
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ==================== 文件上传配置 ====================
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.enabled=true

# 文件存储路径
file.upload-dir=/www/wwwroot/blog-backend/uploads
file.access-path=/uploads/**

# ==================== 邮件配置（可选） ====================
#spring.mail.host=smtp.gmail.com
#spring.mail.port=587
#spring.mail.username=your_email@gmail.com
#spring.mail.password=your_app_password
#spring.mail.properties.mail.smtp.auth=true
#spring.mail.properties.mail.smtp.starttls.enable=true

# ==================== Redis配置（可选） ====================
#spring.redis.host=localhost
#spring.redis.port=6379
#spring.redis.password=
#spring.redis.database=0
#spring.redis.timeout=3000

# ==================== 缓存配置 ====================
spring.cache.type=simple
spring.cache.cache-names=users,projects,tags
spring.cache.simple.size=1000

# ==================== 性能配置 ====================
# Jackson序列化配置
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=Asia/Shanghai
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false

# ==================== 安全配置 ====================
# CORS配置
cors.allowed-origins=http://localhost,http://your-domain.com
cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true

# 激活生产环境profile
spring.profiles.active=prod

# ==================== 监控配置（可选） ====================
# Spring Boot Actuator
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when_authorized
management.endpoint.health.probes.enabled=true

# ==================== 错误处理 ====================
# 错误页面配置
server.error.include-stacktrace=never
server.error.include-message=always
server.error.include-binding-errors=never

# ==================== 数据库初始化 ====================
# 启动时初始化数据库（首次部署后改为none）
spring.sql.init.mode=embedded
spring.sql.init.continue-on-error=true
spring.jpa.hibernate.ddl-auto=update

# ==================== 其他配置 ====================
# 时区配置
user.timezone=Asia/Shanghai

# 应用名称
spring.application.name=my-blog-backend

# 注意：部署前请修改以下配置：
# 1. spring.datasource.password - 数据库密码
# 2. jwt.secret - JWT密钥
# 3. cors.allowed-origins - 允许的前端域名
# 4. file.upload-dir - 文件上传目录